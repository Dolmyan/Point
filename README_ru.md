# üöÄ Point ‚Äî –∫–æ–Ω—Ç–µ–Ω—Ç-–±–æ—Ç –¥–ª—è –∫—Ä–µ–∞—Ç–æ—Ä–æ–≤

**Point** ‚Äî –ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è –∞–≤—Ç–æ—Ä–æ–≤ –∏ –∫—Ä–µ–∞—Ç–æ—Ä–æ–≤: –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–æ—Å—Ç—ã, –∏–¥–µ–∏ –¥–ª—è –≤–∏–¥–µ–æ, –∫–∞—Ä—É—Å–µ–ª–∏, –ø–æ–º–æ–≥–∞–µ—Ç —Å –¥–∏–∑–∞–π–Ω–æ–º –ø—Ä–æ—Ñ–∏–ª—è –∏ –ø—Ä–æ–≥—Ä–µ–≤–æ–º –∞—É–¥–∏—Ç–æ—Ä–∏–∏.  
–ù–∞–ø–∏—Å–∞–Ω –Ω–∞ `aiogram` + `FastAPI`. –¶–µ–ª—å ‚Äî —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç, –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥ –≤–∞—à —Å—Ç–∏–ª—å.

[–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub](https://github.com/Dolmyan/Point) ¬∑ Telegram: [@BigBoyAndroid](https://t.me/BigBoyAndroid)

---

## üìå –ë—ã—Å—Ç—Ä–∞—è —Å–≤–æ–¥–∫–∞
- –Ø–¥—Ä–æ: **Python 3.12**
- –§—Ä–µ–π–º–≤–æ—Ä–∫–∏: `aiogram` (–±–æ—Ç), `FastAPI` (–≤–µ–±-—Å–µ—Ä–≤–∏—Å—ã / –≤–µ–±—Ö—É–∫–∏)
- –ë–∞–∑–∞: `sqlite` (`point.db`)
- –ü–ª–∞—Ç–µ–∂–∏: **YooKassa**
- –†–µ–∂–∏–º –ø—Ä–æ–¥–∞–∫—à–Ω: **webhook** (ngrok –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, VPS ‚Äî –≤ –ø—Ä–æ–¥–µ)
- Dependencies: –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤ `requirements.txt` (–≤ —Ä–µ–ø–æ)

---

## üß≠ –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å](#—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å)  
2. [–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏](#—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏-–∏-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)  
3. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)  
4. [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –ª–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç)](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–ª–æ–∫–∞–ª—å–Ω—ã–π-–∑–∞–ø—É—Å–∫-–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)  
5. [–§–∞–π–ª `.env` ‚Äî —à–∞–±–ª–æ–Ω –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö](#—Ñ–∞–π–ª-env---—à–∞–±–ª–æ–Ω-–∏-–æ–ø–∏—Å–∞–Ω–∏–µ-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö)  
6. [Webhook: –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –ø—Ä–∏–º–µ—Ä –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ (VPS)](#webhook-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–∏-–ø—Ä–∏–º–µ—Ä-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞-vps)  
7. [Nginx + systemd: –ø—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –¥–ª—è VPS](#nginx--systemd-–ø—Ä–∏–º–µ—Ä—ã-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π-–¥–ª—è-vps)  
8. [–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –±—ç–∫–∞–ø—ã](#–±–∞–∑–∞-–¥–∞–Ω–Ω—ã—Ö-–∏-–±—ç–∫–∞–ø—ã)  
9. [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å-–∏-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)  
10. [–ö–æ–º–∞–Ω–¥—ã –∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (UI) ‚Äî –ø—Ä–∏–º–µ—Ä—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è](#–∫–æ–º–∞–Ω–¥—ã-–∏-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã-ui---–ø—Ä–∏–º–µ—Ä—ã-–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è)  
11. [CI / —Ç–µ—Å—Ç—ã / Docker](#ci--—Ç–µ—Å—Ç—ã--docker)  
12. [Roadmap / TODO / –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º](#roadmap--todo--–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö-–ø—Ä–æ–±–ª–µ–º)  
13. [–ö–æ–Ω—Ç–∞–∫—Ç—ã, –≤–∫–ª–∞–¥, –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏](#–∫–æ–Ω—Ç–∞–∫—Ç—ã-–≤–∫–ª–∞–¥-–±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏)

---

## ‚ú® –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
Point –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –Ω–∞ –∫—Ä–µ–∞—Ç–æ—Ä–æ–≤ –∏ –≤–∫–ª—é—á–∞–µ—Ç:
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: —Å–±–æ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —Å—Ç–∏–ª–µ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç **1 –ø—Ä–∏–º–µ—Ä** —Å–≤–æ–µ–≥–æ –ø–æ—Å—Ç–∞ –¥–ª—è –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏).  
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞:
  - `üí° –ò–¥–µ–∏ –ø–æ—Å—Ç–æ–≤`
  - `üìå –ö–∞—Ä—É—Å–µ–ª—å` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ä—É—Å–µ–ª–∏ –¥–ª—è Instagram / Telegram
  - `üé® –î–∏–∑–∞–π–Ω –ø—Ä–æ—Ñ–∏–ª—è` ‚Äî —ç–º–æ–¥–∂–∏, –±–∏–æ –∏ —Å—Ç–∏–ª—å
  - `üé¨ –í–∏–¥–µ–æ –∏–¥–µ–∏`
- –ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ:
  - –ü—Ä–æ–≥—Ä–µ–≤—ã (stories warmup, weekly warmup)
  - –ò–¥–µ–∏ –∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –≤–µ–±–∏–Ω–∞—Ä–æ–≤
  - –ò–¥–µ–∏ —Ä–∞—Å—Å—ã–ª–æ–∫, –∞–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–æ–≤
- –ü–æ–¥–ø–∏—Å–∫–∏ / –ü–ª–∞—Ç–µ–∂–∏: –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å YooKassa, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ (—á–µ—Ä–µ–∑ `SubscriptionManager`).
- –ê–¥–º–∏–Ω/–ø—Ä–æ—Ñ–∏–ª—å: –ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–∫–∏, –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è, –ª–∏–º–∏—Ç—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–π –∏ —Ç.–¥.

---

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤ `requirements.txt` –≤ –∫–æ—Ä–Ω–µ —Ä–µ–ø–æ):

```
aiofiles==24.1.0
aiogram==3.22.0
aiohappyeyeballs==2.6.1
aiohttp==3.12.15
aiosqlite==0.21.0
fastapi==0.116.1
uvicorn==0.35.0
openai==1.102.0
pillow==11.3.0
yookassa==3.7.0
... (–∏ –¥—Ä. ‚Äî —Å–º. requirements.txt)
```

> –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:
```bash
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–∫–æ—Ä–µ–Ω—å `Point/`)
```
Point
‚îú‚îÄ‚îÄ .venv
‚îú‚îÄ‚îÄ app/                      # –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ (—Ä–æ—É—Ç–µ—Ä—ã, —Ö—ç–Ω–¥–ª–µ—Ä—ã)
‚îú‚îÄ‚îÄ post_generation/          # –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ—Å—Ç–æ–≤, –∫–∞—Ä—É—Å–µ–ª–µ–π, —Ä–∏–ª—Å–æ–≤
‚îú‚îÄ‚îÄ promotion/                # –º–æ–¥—É–ª–∏ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—è –∏ –ø—Ä–æ–≥—Ä–µ–≤–∞
‚îú‚îÄ‚îÄ generators.py
‚îú‚îÄ‚îÄ handlers.py
‚îú‚îÄ‚îÄ payment.py
‚îú‚îÄ‚îÄ posts_ideas.py
‚îú‚îÄ‚îÄ profile_design.py
‚îú‚îÄ‚îÄ registration.py
‚îú‚îÄ‚îÄ states.py
‚îú‚îÄ‚îÄ subscription_funcs.py
‚îú‚îÄ‚îÄ subscription_info.py
‚îú‚îÄ‚îÄ video_ideas.py
‚îú‚îÄ‚îÄ .env
‚îú‚îÄ‚îÄ app.log
‚îú‚îÄ‚îÄ config.py
‚îú‚îÄ‚îÄ database.py               # BotDB (sqlite)
‚îú‚îÄ‚îÄ funcs.py
‚îú‚îÄ‚îÄ point.db
‚îú‚îÄ‚îÄ run.py                    # FastAPI + aiogram
‚îî‚îÄ‚îÄ requirements.txt
```

–ö–æ—Ä–æ—Ç–∫–æ –ø–æ —Ñ–∞–π–ª–∞–º/–º–æ–¥—É–ª—è–º:
- `run.py` ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞: –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è `Bot`, `Dispatcher`, `FastAPI`. (–í —Ç–µ–∫—É—â–µ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç polling ‚Äî —Å–º. —Ä–∞–∑–¥–µ–ª Webhook –Ω–∏–∂–µ.)  
- `database.py` ‚Äî –∫–ª–∞—Å—Å `BotDB` (sqlite) —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ `users`, `user_requests`, `user_settings`, `subscriptions`.  
- `subscription_funcs.py` ‚Äî `SubscriptionManager` –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏/–¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–æ–¥–ø–∏—Å–æ–∫.  
- `post_generation/`, `promotion/`, `video_ideas.py`, `profile_design.py` ‚Äî –ª–æ–≥–∏–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.  
- `payment.py` ‚Äî —Ä–æ—É—Ç–µ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π –∏ callback/–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å YooKassa (–≤ `run.py` –µ—Å—Ç—å endpoint `/yookassa/webhook`).

---

## ‚ñ∂Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –ª–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç)
1. –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone https://github.com/Dolmyan/Point.git
cd Point
```

2. –°–æ–∑–¥–∞—ë–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ —Å—Ç–∞–≤–∏–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

3. –°–æ–∑–¥–∞—ë–º —Ñ–∞–π–ª `.env` (—Å–º. —à–∞–±–ª–æ–Ω –Ω–∏–∂–µ) –∏ –∑–∞–ø–æ–ª–Ω—è–µ–º —Ç–æ–∫–µ–Ω—ã.

4. –ó–∞–ø—É—Å–∫–∞–µ–º –ª–æ–∫–∞–ª—å–Ω–æ (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞, polling/ngrok):
```bash
# –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å polling (–∫–∞–∫ —Å–µ–π—á–∞—Å –≤ run.py)
python run.py

# –∏–ª–∏ –∑–∞–ø—É—Å–∫ FastAPI —á–µ—Ä–µ–∑ uvicorn (–µ—Å–ª–∏ want to run web part)
uvicorn run:app --host 0.0.0.0 --port 8000 --reload
```

> –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ webhooks —É–¥–æ–±–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ngrok`:
```bash
ngrok http 8000
# –∑–∞—Ç–µ–º –≤—ã—Å—Ç–∞–≤–∏—Ç—å setWebhook –Ω–∞ Telegram (—Å–º. —Ä–∞–∑–¥–µ–ª Webhook –Ω–∏–∂–µ)
```

---

## üîê `.env.example` ‚Äî —à–∞–±–ª–æ–Ω (–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫ `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å)
```env
# Telegram
TG_TOKEN=your_telegram_bot_token_here

# OpenAI (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
AI_TOKEN=your_openai_api_key_here

# YooKassa
SHOP_ID=your_yookassa_shop_id
YK_TOKEN=your_yookassa_secret_key

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
WEBHOOK_URL=https://your-domain-or-ngrok-url/telegram/webhook  # –ø—Ä–∏–º–µ—Ä
DB_PATH=point.db
LOG_LEVEL=INFO
```


---

## üîÅ Webhook: –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–ª–æ–∫–∞–ª—å–Ω–æ ‚Üí VPS)
–í `run.py` —Å–µ–π—á–∞—Å –µ—Å—Ç—å `FastAPI` –∏ endpoint –¥–ª—è YooKassa (`/yookassa/webhook`). –î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ webhook-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –æ—Ç Telegram –Ω–∞ –ø—Ä–æ–¥–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å HTTPS URL —É Telegram:
```bash
curl -F "url=https://<your-domain>/telegram/webhook" "https://api.telegram.org/bot$TG_TOKEN/setWebhook"
```

2. –û–±–µ—Å–ø–µ—á–∏—Ç—å HTTPS (Let's Encrypt / certbot) –∏–ª–∏ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ nginx (HTTPS) –Ω–∞ –≤–∞—à uvicorn.

3. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è webhook-–ø—Ä–∏—ë–º–∞:
- –í –ø—Ä–æ—Å—Ç–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ –≤—ã –¥–æ–±–∞–≤–ª—è–µ—Ç–µ —Ä–æ—É—Ç `/telegram/webhook` –≤ `FastAPI`, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç JSON –æ—Ç Telegram –∏ –ø–µ—Ä–µ–¥–∞—ë—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ `Dispatcher` (dp) –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏.
- –í `run.py` –Ω–∞ production: –≤–º–µ—Å—Ç–æ `dp.start_polling()` –¥–µ–ª–∞–µ–º —É—Å—Ç–∞–Ω–æ–≤–∫—É webhook –≤ startup –∏ —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏ shutdown.

> –ü—Ä–∏–º–µ—Ä –ª–æ–≥–∏–∫–∏ (—Å—Ö–µ–º–∞ ‚Äî –∞–¥–∞–ø—Ç–∏—Ä—É–π –ø–æ–¥ –∫–æ–¥):
```py
# –≤ run.py (–ø—Å–µ–≤–¥–æ-–∫–æ–¥):
from aiogram import types

@app.post("/telegram/webhook")
async def telegram_webhook(request: Request):
    data = await request.json()
    update = types.Update(**data)
    await dp.process_update(update)   # –∏–ª–∏ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –º–µ—Ç–æ–¥ Dispatcher –≤ aiogram v3
    return {"ok": True}
```

> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ webhook (–ø—Ä–∏–º–µ—Ä):
```bash
curl -F "url=https://example.com/telegram/webhook" "https://api.telegram.org/bot$TG_TOKEN/setWebhook"
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** API aiogram/Dispatcher –∏–º–µ–µ—Ç —Ä–∞–∑–Ω—ã–µ helper-–º–µ—Ç–æ–¥—ã –≤ —Ä–∞–∑–Ω—ã—Ö –≤–µ—Ä—Å–∏—è—Ö ‚Äî –ø—Ä–æ–≤–µ—Ä—å `aiogram` –¥–æ–∫–∏ –¥–ª—è `dp.process_update` / `dp.feed_update`. –ï—Å–ª–∏ –Ω–µ —É–≤–µ—Ä–µ–Ω—ã ‚Äî –æ—Å—Ç–∞–≤—å—Ç–µ `dp.start_polling()` –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –¥–µ–ª–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª/—Ä–µ–∂–∏–º –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞.

---

## üß∞ Nginx + systemd ‚Äî –ø—Ä–∏–º–µ—Ä –¥–µ–ø–ª–æ—è –Ω–∞ VPS (Timeweb / –ª—é–±–æ–π VPS)
–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º: `uvicorn` —Å–ª—É—à–∞–µ—Ç `127.0.0.1:8000`. Nginx ‚Äî –ø—É–±–ª–∏—á–Ω—ã–π HTTPS-–ø—Ä–æ–∫—Å–∏.

### Nginx –∫–æ–Ω—Ñ–∏–≥ (–ø—Ä–∏–º–µ—Ä)
`/etc/nginx/sites-available/point`:
```nginx
server {
    listen 80;
    server_name example.com;

    location / {
        return 301 https://$host$request_uri;
    }
}

server {
    listen 443 ssl;
    server_name example.com;

    ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;

    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_buffering off;
    }
}
```

### systemd unit (–ø—Ä–∏–º–µ—Ä)
`/etc/systemd/system/point.service`:
```ini
[Unit]
Description=Point bot (uvicorn)
After=network.target

[Service]
User=someuser
Group=somegroup
WorkingDirectory=/home/someuser/Point
Environment="PATH=/home/someuser/Point/.venv/bin"
ExecStart=/home/someuser/Point/.venv/bin/uvicorn run:app --host 127.0.0.1 --port 8000
Restart=on-failure
RestartSec=5s

[Install]
WantedBy=multi-user.target
```

–ö–æ–º–∞–Ω–¥—ã:
```bash
sudo systemctl daemon-reload
sudo systemctl enable --now point.service
sudo nginx -t && sudo systemctl restart nginx
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—ã–∑–æ–≤–∏ `setWebhook` —Å `https://example.com/telegram/webhook`.

---

## üíæ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –±—ç–∫–∞–ø—ã
`BotDB` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç sqlite: `point.db`. –¢–∞–±–ª–∏—Ü—ã:
- `users(user_id, username, created_at, status, thread_id)`
- `user_requests(user_id, count, request_limit)`
- `user_settings(user_id, style, business)`
- `subscriptions(user_id, status, free_generations, carousel_count, subscription_end, created_at, updated_at)`

–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±—ç–∫–∞–ø—É:
- –†–µ–≥—É–ª—è—Ä–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª `point.db` (rsync / cron):
```bash
# –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±—ç–∫–∞–ø (–ø—Ä–∏–º–µ—Ä –≤ crontab)
0 3 * * * cp /home/someuser/Point/point.db /home/someuser/backups/point_$(date +\%F).db
```
- –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ö–µ–º—ã ‚Äî –¥–µ—Ä–∂–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –∏–ª–∏ —Å–∫—Ä–∏–ø—Ç—ã schema-upgrade (—Ä—É—á–Ω—ã–µ ALTER/CREATE).
- –î–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `sqlite3`:
```bash
sqlite3 point.db ".backup 'backup.db'"
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- **–ù–∏–∫–æ–≥–¥–∞** –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å `.env` –∏–ª–∏ —Å–µ–∫—Ä–µ—Ç—ã –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π. `.gitignore` —É–∂–µ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å `.env`.
- –ò—Å–ø–æ–ª—å–∑—É–π HTTPS –¥–ª—è webhook (Let's Encrypt).
- –•—Ä–∞–Ω–∏ —Ç–æ–∫–µ–Ω—ã –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ –∏ —Ä–æ—Ç–∞—Ü–∏—Ä—É–π –∫–ª—é—á–∏ –ø—Ä–∏ —É—Ç–µ—á–∫–µ.
- –ù–∞ VPS ‚Äî –¥–æ–±–∞–≤—å –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä (ufw/iptables) –∏ –æ–≥—Ä–∞–Ω–∏—á—å –¥–æ—Å—Ç—É–ø –ø–æ SSH (–∫–ª—é—á–∏, 2FA).
- –î–∞–π webhook URL —Å —Å–µ–∫—Ä–µ—Ç–Ω—ã–º –ø—Ä–µ—Ñ–∏–∫—Å–æ–º: `/telegram/webhook/<random_secret>` ‚Äî —á—Ç–æ–±—ã —É—Å–ª–æ–∂–Ω–∏—Ç—å –ø–æ–¥–±–æ—Ä.
- –õ–æ–≥–∏: —Ä–æ—Ç–∏—Ä—É–π (`RotatingFileHandler` —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `run.py`).
- –î–ª—è YooKassa –∏—Å–ø–æ–ª—å–∑—É–π —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏ –≤ dev, —Ä–µ–∞–ª—å–Ω—ã–µ ‚Äî –≤ prod.

---

## ‚å®Ô∏è –ö–æ–º–∞–Ω–¥—ã –∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã ‚Äî –ø—Ä–∏–º–µ—Ä—ã UI
–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é (–ø—Ä–∏–º–µ—Ä –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã):
```
üí° –ò–¥–µ–∏ –ø–æ—Å—Ç–æ–≤
üìå –ö–∞—Ä—É—Å–µ–ª—å
üé® –î–∏–∑–∞–π–Ω –ø—Ä–æ—Ñ–∏–ª—è
üé¨ –í–∏–¥–µ–æ –∏–¥–µ–∏
üöÄ –ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ
üõ†Ô∏è –ü—Ä–æ—Ñ–∏–ª—å
```

Inline-–º–µ–Ω—é –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—è:
- –ü—Ä–æ–≥—Ä–µ–≤ –≤ —Å—Ç–æ—Ä–∏—Å (`stories_warmup`)
- –ù–µ–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ–≤ (`weekly_warmup`)
- –ò–¥–µ–∏ –≤–µ–±–∏–Ω–∞—Ä–æ–≤ (`webinar_ideas`)
- –°—Ü–µ–Ω–∞—Ä–∏–π –≤–µ–±–∏–Ω–∞—Ä–∞ (`webinar_script`)
- –ò–¥–µ–∏ —Ä–∞—Å—Å—ã–ª–æ–∫ (`newsletter_ideas`)
- –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–æ–≤ (`trand_analysis`)

–ü—Ä–∏–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (–≤ `registration`):
> üí™ **–ü–æ–∫–∞–∂–∏ —Å–≤–æ–π —Å—Ç–∏–ª—å!**  
> –ß—Ç–æ–±—ã —è –ø–æ–Ω—è–ª —Ç–≤–æ–π –ø–æ–¥—Ö–æ–¥, –æ—Ç–ø—Ä–∞–≤—å **–æ–¥–∏–Ω –ø—Ä–∏–º–µ—Ä** —Ç–≤–æ–µ–≥–æ –ø–æ—Å—Ç–∞ –∏–ª–∏ —Å—Ü–µ–Ω–∞—Ä–∏—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∞ **¬´Telegram¬ª** ‚Äî –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏–º–µ—Ä —Ç–æ–ª—å–∫–æ –∏–∑ —Ç–≤–æ–∏—Ö —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤.  
> üìù –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ–¥ —Ç–≤–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å.

---

## üì¶ CI / —Ç–µ—Å—Ç—ã / Docker
- –î–æ–∫–µ—Ä–∞ –≤ –ø—Ä–æ–µ–∫—Ç–µ –Ω–µ –±—É–¥–µ—Ç (–ø–æ —Ç–≤–æ–µ–º—É –∑–∞–ø—Ä–æ—Å—É).  
- –ï—Å–ª–∏ –ø–æ–∑–∂–µ –∑–∞—Ö–æ—á–µ—à—å ‚Äî –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å `Dockerfile` –∏ `docker-compose` –¥–ª—è —É–ø—Ä–æ—â—ë–Ω–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è.  
- –¢–µ—Å—Ç–æ–≤ –Ω–µ—Ç; —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –¥–æ–±–∞–≤–∏—Ç—å –±–∞–∑–æ–≤—ã–µ unit-—Ç–µ—Å—Ç—ã –¥–ª—è `database.py` –∏ –∫–ª—é—á–µ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥ –≤–∫–ª—é—á–µ–Ω–∏–µ–º CI.  
- –ï—Å–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è ‚Äî –ø–æ–¥–≥–æ—Ç–æ–≤–ª—é `GitHub Actions` workflow –¥–ª—è –ª–∏–Ω—Ç–∏–Ω–≥–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

---

## üß≠ Roadmap / TODO
- ‚úÖ –ë–∞–∑–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ—Å—Ç–æ–≤, –∫–∞—Ä—É—Å–µ–ª–µ–π –∏ —Ä–∏–ª—Å–æ–≤  
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è YooKassa (webhook —É–∂–µ –µ—Å—Ç—å)  
- üî≤ Webhook-ready production mode (—Å–º–µ–Ω–∏—Ç—å polling ‚Üí webhook) ‚Äî –≤ README –æ–ø–∏—Å–∞–Ω–æ –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å  
- üî≤ –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î / –≤–µ—Ä—Å–∏—è —Å—Ö–µ–º—ã  
- üî≤ –Æ–Ω–∏—Ç/–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã  
- üî≤ Dockerfile (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üì¨ –ö–æ–Ω—Ç–∞–∫—Ç—ã, –≤–∫–ª–∞–¥, –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏
- –†–µ–ø–æ: https://github.com/Dolmyan/Point  
- –ê–≤—Ç–æ—Ä / –∫–æ–Ω—Ç–∞–∫—Ç: @BigBoyAndroid (Telegram)  
- –í–∫–ª–∞–¥: PR –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è. –ü—É–ª–ª-—Ä–µ–∫–≤–µ—Å—Ç—ã ‚Äî –æ–ø–∏—Å—ã–≤–∞–π—Ç–µ –∫–æ—Ä–æ—Ç–∫–æ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏.

---

## üìù –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã (–∫–æ—Ä–æ—Ç–∫–æ)
```bash
git clone https://github.com/Dolmyan/Point.git
cd Point

python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt

# –∑–∞–ø—É—Å–∫ (dev)
python run.py
# –∏–ª–∏
uvicorn run:app --host 0.0.0.0 --port 8000 --reload

# set webhook (–ø—Ä–∏–º–µ—Ä)
curl -F "url=https://example.com/telegram/webhook" "https://api.telegram.org/bot$TG_TOKEN/setWebhook"
```

---

